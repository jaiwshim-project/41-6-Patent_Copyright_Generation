<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íŠ¹í—ˆ ì¶œì› ê³ ë„í™” | AI-IP Strategy OS</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <style>
    .patent-header {
      background: linear-gradient(135deg, #0f2460 0%, #1e40af 50%, #4c1d95 100%);
      padding: 2.5rem 2rem;
      border-bottom: 1px solid rgba(100,180,255,0.15);
    }
    /* Header title â€” gold */
    .patent-header h1 { color: #fcd34d !important; }
    .patent-header p  { color: rgba(255,255,255,0.82) !important; }

    .step-panel { display: none; }
    .step-panel.active { display: block; }
    .score-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
      margin: 1.5rem 0;
    }
    .claim-text-area {
      background: transparent;
      border: none;
      width: 100%;
      color: var(--text-200);
      font-size: 0.875rem;
      line-height: 1.8;
      resize: none;
      outline: none;
      font-family: inherit;
    }
    .final-spec {
      background: #fafcff;
      border: 1.5px solid #e2e8f0;
      border-radius: 12px;
      padding: 1.75rem;
    }
    .risk-meter {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.25rem;
      border-radius: 10px;
      border: 1.5px solid #e2e8f0;
      background: #f8fafc;
      margin-bottom: 0.75rem;
    }
    .risk-pct { font-size: 1.5rem; font-weight: 800; min-width: 60px; }
    @media (max-width: 768px) {
      .score-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>

<!-- Navbar injected by layout.js -->

<!-- Header -->
<div class="patent-header">
  <div class="container">
    <div style="display:flex;align-items:center;gap:1rem;margin-bottom:0.75rem">
      <span style="font-size:2rem">âš™ï¸</span>
      <div>
        <h1 style="font-size:1.75rem;font-weight:800">íŠ¹í—ˆ ì¶œì› ê³ ë„í™”</h1>
        <p style="color:rgba(255,255,255,0.7);font-size:0.9rem">ì•„ì´ë””ì–´ â†’ ê¸°ìˆ  ë¶„ì„ â†’ ì²­êµ¬í•­ ì„¤ê³„ â†’ ëª…ì„¸ì„œ ì™„ì„± (7ë‹¨ê³„)</p>
      </div>
    </div>
    <div id="projectInfoBar" style="background:rgba(0,0,0,0.2);border-radius:8px;padding:0.75rem 1rem;font-size:0.875rem;color:rgba(255,255,255,0.8)">
      í”„ë¡œì íŠ¸ ë¡œë”© ì¤‘...
    </div>
  </div>
</div>

<!-- Main -->
<div class="page-content">

  <!-- Step Navigation -->
  <div class="step-nav-wrap">
    <button class="step-btn active" id="nav-1" onclick="goStep(1)">
      <span class="step-n">1</span>í•µì‹¬ ì¶”ì¶œ
    </button>
    <button class="step-btn" id="nav-2" onclick="goStep(2)">
      <span class="step-n">2</span>ì„ í–‰ê¸°ìˆ  ë¶„ì„
    </button>
    <button class="step-btn" id="nav-3" onclick="goStep(3)">
      <span class="step-n">3</span>êµ¬ì„±ìš”ì†Œ ë¶„í•´
    </button>
    <button class="step-btn" id="nav-4" onclick="goStep(4)">
      <span class="step-n">4</span>ì²­êµ¬í•­ ì„¤ê³„
    </button>
    <button class="step-btn" id="nav-5" onclick="goStep(5)">
      <span class="step-n">5</span>ì‹¤ì‹œì˜ˆ ìƒì„±
    </button>
    <button class="step-btn" id="nav-6" onclick="goStep(6)">
      <span class="step-n">6</span>íŠ¹í—ˆ ì ìˆ˜
    </button>
    <button class="step-btn" id="nav-7" onclick="goStep(7)">
      <span class="step-n">7</span>ìµœì¢… ëª…ì„¸ì„œ
    </button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 1 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel active" id="step-1">
    <div class="grid-2" style="gap:2rem">
      <div>
        <div class="card" style="margin-bottom:1.5rem">
          <h2 class="section-title" style="font-size:1.2rem">STEP 1 Â· ê¸°ìˆ  í•µì‹¬ ì¶”ì¶œ</h2>
          <p class="section-sub" style="margin-bottom:1rem">AIê°€ ì…ë ¥ëœ ì•„ì´ë””ì–´ì—ì„œ ë°œëª…ì˜ í•µì‹¬ì„ ìë™ ë¶„ì„í•©ë‹ˆë‹¤.</p>

          <div class="form-group">
            <label class="form-label">ë°œëª… ë‚´ìš© í™•ì¸ ë° ë³´ì™„</label>
            <textarea id="s1Idea" class="form-textarea" style="min-height:180px"
              placeholder="ì•„ì´ë””ì–´ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ indexì—ì„œ ë¶ˆëŸ¬ì˜¨ ë‚´ìš©ì„ í™•ì¸í•˜ì„¸ìš”."></textarea>
          </div>

          <div class="form-group">
            <label class="form-label">ê¸°ìˆ  ìœ í˜• ì„ íƒ</label>
            <select id="s1TechType" class="form-select">
              <option value="ìë™ë¶„ë¥˜">AI ìë™ ë¶„ë¥˜</option>
              <option value="ì•Œê³ ë¦¬ì¦˜í˜•">ì•Œê³ ë¦¬ì¦˜ / ì†Œí”„íŠ¸ì›¨ì–´</option>
              <option value="ì‹œìŠ¤í…œí˜•">ì‹œìŠ¤í…œ / í”Œë«í¼</option>
              <option value="ì¥ì¹˜í˜•">ì¥ì¹˜ / í•˜ë“œì›¨ì–´</option>
              <option value="ê³µì •í˜•">ê³µì • / ì œì¡°ë°©ë²•</option>
              <option value="ìœµí•©í˜•">AI/SW ìœµí•©í˜•</option>
            </select>
          </div>

          <button class="btn btn-primary btn-full" onclick="runStep1()">
            ğŸ§  í•µì‹¬ ì¶”ì¶œ ì‹¤í–‰
          </button>
        </div>

        <div class="card">
          <label class="form-label" style="margin-bottom:0.75rem">ì¶”ê°€ ì§ˆë¬¸ ë‹µë³€ (ì„ íƒ)</label>
          <div class="form-group">
            <label class="form-label" style="font-size:0.75rem">ê¸°ì¡´ ê¸°ìˆ ê³¼ ê°€ì¥ ë‹¤ë¥¸ ì </label>
            <input type="text" id="s1Diff" class="form-input" placeholder="ì˜ˆ: ì‹¤ì‹œê°„ ì²˜ë¦¬ ì†ë„ê°€ 10ë°° ë¹ ë¦„">
          </div>
          <div class="form-group">
            <label class="form-label" style="font-size:0.75rem">ìƒì—…ì ìœ¼ë¡œ ê°€ì¥ ì¤‘ìš”í•œ ìš”ì†Œ</label>
            <input type="text" id="s1Commerce" class="form-input" placeholder="ì˜ˆ: êµ¬ë… SaaS ëª¨ë¸, API ë¼ì´ì„ ì‹±">
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label class="form-label" style="font-size:0.75rem">êµ¬í˜„ ì˜ˆì‹œ (ìˆë‹¤ë©´)</label>
            <input type="text" id="s1Example" class="form-input" placeholder="ì˜ˆ: GitHub ë§í¬, í”„ë¡œí† íƒ€ì… URL">
          </div>
        </div>
      </div>

      <div>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
            <h3 style="font-weight:700">AI ë¶„ì„ ê²°ê³¼</h3>
            <div id="s1Loading" style="display:none"><div class="spinner"></div></div>
          </div>
          <div id="s1Result" class="result-box" style="min-height:400px">
            <span style="color:var(--text-secondary)">ì‹¤í–‰ ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ AIê°€ í•µì‹¬ì„ ë¶„ì„í•©ë‹ˆë‹¤.</span>
          </div>
        </div>
        <div style="text-align:right;margin-top:1rem">
          <button class="btn btn-primary" onclick="goStep(2)" id="s1Next" disabled>
            ë‹¤ìŒ: ì„ í–‰ê¸°ìˆ  ë¶„ì„ â†’
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 2 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel" id="step-2">
    <div class="grid-2" style="gap:2rem">
      <div>
        <div class="card">
          <h2 class="section-title" style="font-size:1.2rem">STEP 2 Â· ì„ í–‰ê¸°ìˆ  ëŒ€ë¹„ ì°¨ë³„ì„± ë¶„ì„</h2>
          <p class="section-sub" style="margin-bottom:1rem">ê¸°ì¡´ ê¸°ìˆ ê³¼ì˜ ì°¨ë³„ì ê³¼ ì‹ ê·œì„± ìœ„í—˜ì„ AIê°€ ë¶„ì„í•©ë‹ˆë‹¤.</p>

          <div class="form-group">
            <label class="form-label">ì„ í–‰ê¸°ìˆ  ê²€ìƒ‰ ë²”ìœ„</label>
            <select id="s2Scope" class="form-select">
              <option value="êµ­ë‚´ì™¸">êµ­ë‚´ì™¸ ì „ì²´ (ê¶Œì¥)</option>
              <option value="êµ­ë‚´">êµ­ë‚´ (KIPRIS)</option>
              <option value="ë¯¸êµ­">ë¯¸êµ­ (USPTO)</option>
              <option value="ìœ ëŸ½">ìœ ëŸ½ (EPO)</option>
              <option value="PCT">PCT êµ­ì œì¶œì›</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">ì¶”ê°€ í‚¤ì›Œë“œ (ì„ íƒ)</label>
            <input type="text" id="s2Keywords" class="form-input"
              placeholder="ê²€ìƒ‰ì— í¬í•¨í•  í•µì‹¬ í‚¤ì›Œë“œ (ì‰¼í‘œ êµ¬ë¶„)">
          </div>

          <button class="btn btn-primary btn-full" onclick="runStep2()">
            ğŸ” ì„ í–‰ê¸°ìˆ  ë¶„ì„ ì‹¤í–‰
          </button>
        </div>

        <div class="card" style="margin-top:1.5rem">
          <h3 style="font-weight:700;margin-bottom:1rem">ì‹ ê·œì„± ìœ„í—˜ í‰ê°€</h3>
          <div id="s2Risk">
            <div style="color:var(--text-secondary);font-size:0.875rem">ë¶„ì„ í›„ ìë™ ìƒì„±ë©ë‹ˆë‹¤.</div>
          </div>
        </div>
      </div>

      <div>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
            <h3 style="font-weight:700">ì„ í–‰ê¸°ìˆ  ë¶„ì„ ê²°ê³¼</h3>
            <div id="s2Loading" style="display:none"><div class="spinner"></div></div>
          </div>
          <div id="s2Result" class="result-box" style="min-height:420px">
            <span style="color:var(--text-secondary)">ë¶„ì„ ì‹¤í–‰ í›„ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</span>
          </div>
        </div>
        <div style="text-align:right;margin-top:1rem">
          <button class="btn btn-primary" onclick="goStep(3)" id="s2Next" disabled>
            ë‹¤ìŒ: êµ¬ì„±ìš”ì†Œ ë¶„í•´ â†’
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 3 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel" id="step-3">
    <div class="grid-2" style="gap:2rem">
      <div>
        <div class="card">
          <h2 class="section-title" style="font-size:1.2rem">STEP 3 Â· ë°œëª… êµ¬ì„±ìš”ì†Œ ë¶„í•´</h2>
          <p class="section-sub" style="margin-bottom:1rem">ë°œëª…ì„ êµ¬ì„±í•˜ëŠ” í•µì‹¬ ìš”ì†Œì™€ ì‘ë™ íë¦„ì„ ì²´ê³„í™”í•©ë‹ˆë‹¤.</p>

          <div class="form-group">
            <label class="form-label">í•„ìˆ˜ ë³´í˜¸ êµ¬ì„±ìš”ì†Œ (ì§ì ‘ ì…ë ¥ ê°€ëŠ¥)</label>
            <textarea id="s3Core" class="form-textarea"
              placeholder="ë°˜ë“œì‹œ ì²­êµ¬í•­ì— í¬í•¨í•´ì•¼ í•  í•µì‹¬ êµ¬ì„±ìš”ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”.&#10;ì˜ˆ: AI ì¶”ë¡  ì—”ì§„, ì‹¤ì‹œê°„ ì²˜ë¦¬ ëª¨ë“ˆ, ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤"></textarea>
          </div>

          <button class="btn btn-primary btn-full" onclick="runStep3()">
            ğŸ”§ êµ¬ì„±ìš”ì†Œ ë¶„í•´ ì‹¤í–‰
          </button>
        </div>
      </div>

      <div>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
            <h3 style="font-weight:700">êµ¬ì„± ë¶„í•´ ê²°ê³¼</h3>
            <div id="s3Loading" style="display:none"><div class="spinner"></div></div>
          </div>
          <div id="s3Result" class="result-box" style="min-height:380px">
            <span style="color:var(--text-secondary)">ë¶„ì„ ì‹¤í–‰ í›„ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤.</span>
          </div>
        </div>
        <div style="text-align:right;margin-top:1rem">
          <button class="btn btn-primary" onclick="goStep(4)" id="s3Next" disabled>
            ë‹¤ìŒ: ì²­êµ¬í•­ ì„¤ê³„ â†’
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 4 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel" id="step-4">
    <div class="card" style="margin-bottom:1.5rem">
      <h2 class="section-title" style="font-size:1.2rem">STEP 4 Â· ì²­êµ¬í•­ ì„¤ê³„</h2>
      <p class="section-sub" style="margin-bottom:1rem">ë…ë¦½í•­ Â· ì¢…ì†í•­ Â· íšŒí”¼ì„¤ê³„ ë°©ì–´í•­ì„ AIê°€ ìë™ ì„¤ê³„í•©ë‹ˆë‹¤.</p>

      <div class="grid-2" style="gap:1rem;margin-bottom:1.5rem">
        <div>
          <label class="form-label">ë…ë¦½í•­ ìˆ˜</label>
          <select id="s4IndepCount" class="form-select">
            <option value="1">1ê°œ (ìµœì†Œ)</option>
            <option value="2">2ê°œ (ë°©ë²•+ì‹œìŠ¤í…œ)</option>
            <option value="3" selected>3ê°œ (ë°©ë²•+ì‹œìŠ¤í…œ+ì¥ì¹˜)</option>
          </select>
        </div>
        <div>
          <label class="form-label">ì¢…ì†í•­ ìˆ˜</label>
          <select id="s4DepCount" class="form-select">
            <option value="10">10ê°œ</option>
            <option value="15" selected>15ê°œ (ê¶Œì¥)</option>
            <option value="20">20ê°œ (ìµœëŒ€ ë³´í˜¸)</option>
          </select>
        </div>
      </div>

      <button class="btn btn-primary" onclick="runStep4()" style="margin-right:0.75rem">
        âœï¸ ì²­êµ¬í•­ ìë™ ìƒì„±
      </button>
      <div id="s4Loading" style="display:none;display:inline-block"><div class="spinner"></div></div>
    </div>

    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
        <h3 style="font-weight:700">ìƒì„±ëœ ì²­êµ¬í•­</h3>
        <button class="btn btn-outline" style="font-size:0.8rem;padding:0.4rem 0.75rem" onclick="addClaim()">+ í•­ ì¶”ê°€</button>
      </div>
      <div id="s4Claims" class="claim-list">
        <div style="color:var(--text-secondary);font-size:0.875rem">ì²­êµ¬í•­ ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</div>
      </div>
    </div>

    <div style="text-align:right;margin-top:1.5rem">
      <button class="btn btn-primary" onclick="goStep(5)" id="s4Next" disabled>
        ë‹¤ìŒ: ì‹¤ì‹œì˜ˆ ìƒì„± â†’
      </button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 5 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel" id="step-5">
    <div class="grid-2" style="gap:2rem">
      <div>
        <div class="card">
          <h2 class="section-title" style="font-size:1.2rem">STEP 5 Â· ì‹¤ì‹œì˜ˆ ìë™ ìƒì„±</h2>
          <p class="section-sub" style="margin-bottom:1rem">êµ¬ì²´ì  êµ¬í˜„ ì‚¬ë¡€ì™€ ë³€í˜• ì‹¤ì‹œì˜ˆë¥¼ ìƒì„±í•˜ì—¬ ê¶Œë¦¬ ë²”ìœ„ë¥¼ í™•ì¥í•©ë‹ˆë‹¤.</p>

          <div class="form-group">
            <label class="form-label">ì‹¤ì‹œì˜ˆ ìœ í˜•</label>
            <select id="s5Type" class="form-select">
              <option value="standard">í‘œì¤€ ì‹¤ì‹œì˜ˆ (êµ¬ì²´ì  êµ¬í˜„)</option>
              <option value="variation">ë³€í˜• ì‹¤ì‹œì˜ˆ í¬í•¨</option>
              <option value="industry">ì‚°ì—…ë³„ ì ìš© ì‚¬ë¡€</option>
            </select>
          </div>

          <button class="btn btn-primary btn-full" onclick="runStep5()">
            ğŸ“‹ ì‹¤ì‹œì˜ˆ ìƒì„± ì‹¤í–‰
          </button>
        </div>
      </div>

      <div>
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
            <h3 style="font-weight:700">ì‹¤ì‹œì˜ˆ ê²°ê³¼</h3>
            <div id="s5Loading" style="display:none"><div class="spinner"></div></div>
          </div>
          <div id="s5Result" class="result-box" style="min-height:360px">
            <span style="color:var(--text-secondary)">ì‹¤ì‹œì˜ˆ ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.</span>
          </div>
        </div>
        <div style="text-align:right;margin-top:1rem">
          <button class="btn btn-primary" onclick="goStep(6)" id="s5Next" disabled>
            ë‹¤ìŒ: íŠ¹í—ˆ ì ìˆ˜ í‰ê°€ â†’
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 6 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel" id="step-6">
    <div class="card" style="margin-bottom:1.5rem">
      <h2 class="section-title" style="font-size:1.2rem">STEP 6 Â· íŠ¹í—ˆ ì ìˆ˜í™” (PSM) & ê¶Œë¦¬ ê°•ë„ (RSI)</h2>
      <p class="section-sub" style="margin-bottom:1.5rem">ê° í•­ëª©ì„ í‰ê°€í•˜ì—¬ íŠ¹í—ˆ ê°•ë„ì™€ ì „ëµì  ê¶Œë¦¬ ì§€ìˆ˜ë¥¼ ì‚°ì¶œí•©ë‹ˆë‹¤.</p>

      <div class="score-grid">
        <div class="score-card">
          <div class="score-value" id="sc_novelty" style="color:#60a5fa">3</div>
          <input type="range" class="score-slider" id="sl_novelty" min="1" max="5" value="3" oninput="updateScore('novelty')">
          <div class="score-name">ì‹ ê·œì„± (Ã—25%)</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="sc_inventive" style="color:#a78bfa">3</div>
          <input type="range" class="score-slider" id="sl_inventive" min="1" max="5" value="3" oninput="updateScore('inventive')">
          <div class="score-name">ì§„ë³´ì„± (Ã—20%)</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="sc_industrial" style="color:#34d399">3</div>
          <input type="range" class="score-slider" id="sl_industrial" min="1" max="5" value="3" oninput="updateScore('industrial')">
          <div class="score-name">ì‚°ì—…ì„± (Ã—10%)</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="sc_effect" style="color:#fbbf24">3</div>
          <input type="range" class="score-slider" id="sl_effect" min="1" max="5" value="3" oninput="updateScore('effect')">
          <div class="score-name">ê¸°ìˆ íš¨ê³¼ (Ã—10%)</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="sc_claims" style="color:#f87171">3</div>
          <input type="range" class="score-slider" id="sl_claims" min="1" max="5" value="3" oninput="updateScore('claims')">
          <div class="score-name">ì²­êµ¬í•­ ì™„ì„±ë„ (Ã—15%)</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="sc_defense" style="color:#fb923c">3</div>
          <input type="range" class="score-slider" id="sl_defense" min="1" max="5" value="3" oninput="updateScore('defense')">
          <div class="score-name">ë°©ì–´ë ¥ (Ã—10%)</div>
        </div>
        <div class="score-card">
          <div class="score-value" id="sc_expansion" style="color:#38bdf8">3</div>
          <input type="range" class="score-slider" id="sl_expansion" min="1" max="5" value="3" oninput="updateScore('expansion')">
          <div class="score-name">í™•ì¥ì„± (Ã—10%)</div>
        </div>
        <div class="score-card" style="background:var(--bg-card2)">
          <div class="score-value" id="psm_total" style="color:#ffffff;font-size:2.5rem">60</div>
          <div class="score-name" style="font-weight:700">PSM ì´ì </div>
          <div id="psm_grade" class="badge badge-yellow" style="margin-top:0.5rem">ì–‘í˜¸</div>
        </div>
      </div>
    </div>

    <!-- RSI -->
    <div class="grid-2" style="gap:1.5rem;margin-bottom:1.5rem">
      <div class="card">
        <h3 style="font-weight:700;margin-bottom:1.25rem">RSI ê¶Œë¦¬ ê°•ë„ ì§€ìˆ˜</h3>
        <div class="form-group">
          <label class="form-label" style="font-size:0.75rem">ë²•ì  ì•ˆì •ì„± (L) <span id="rsi_l_val">5</span>/10</label>
          <input type="range" class="score-slider" id="rsi_l" min="1" max="10" value="5" oninput="updateRSI()">
        </div>
        <div class="form-group">
          <label class="form-label" style="font-size:0.75rem">ê¸°ìˆ  ë³µì¡ë„ (T) <span id="rsi_t_val">5</span>/10</label>
          <input type="range" class="score-slider" id="rsi_t" min="1" max="10" value="5" oninput="updateRSI()">
        </div>
        <div class="form-group">
          <label class="form-label" style="font-size:0.75rem">ì‹œì¥ ë…ì ì„± (M) <span id="rsi_m_val">5</span>/10</label>
          <input type="range" class="score-slider" id="rsi_m" min="1" max="10" value="5" oninput="updateRSI()">
        </div>
        <div class="form-group" style="margin-bottom:0">
          <label class="form-label" style="font-size:0.75rem">ìš°íšŒ ê°€ëŠ¥ì„± (V) <span id="rsi_v_val">5</span>/10</label>
          <input type="range" class="score-slider" id="rsi_v" min="1" max="10" value="5" oninput="updateRSI()">
        </div>
      </div>

      <div class="card" style="text-align:center">
        <h3 style="font-weight:700;margin-bottom:1.5rem">RSI ì§€ìˆ˜ ê²°ê³¼</h3>
        <div style="font-size:4rem;font-weight:900;color:#60a5fa;line-height:1" id="rsi_value">25</div>
        <div id="rsi_grade" class="badge badge-yellow" style="margin:0.75rem auto;display:inline-block;font-size:1rem;padding:0.5rem 1.5rem">ë³´í†µ</div>
        <div class="rsi-gauge">
          <div class="rsi-needle" id="rsi_needle" style="left:30%"></div>
        </div>
        <div style="display:flex;justify-content:space-between;font-size:0.7rem;color:var(--text-secondary)">
          <span>ì•½í•¨</span><span>ë³´í†µ</span><span>ê°•í•¨</span><span>í•µì‹¬</span>
        </div>
        <div style="margin-top:1.5rem">
          <div style="font-size:0.8rem;color:var(--text-secondary)">RSI = (L Ã— T Ã— M) / V</div>
        </div>
      </div>
    </div>

    <!-- Rejection Probability -->
    <div class="card">
      <h3 style="font-weight:700;margin-bottom:1rem">ê±°ì ˆ í™•ë¥  ì˜ˆì¸¡ (ML ì‹œë®¬ë ˆì´ì…˜)</h3>
      <div class="grid-2" style="gap:1rem">
        <div>
          <div class="form-group">
            <label class="form-label" style="font-size:0.75rem">ì„ í–‰ê¸°ìˆ  ìœ ì‚¬ë„ ì¶”ì • (%)</label>
            <input type="range" class="score-slider" id="rej_sim" min="0" max="100" value="30" oninput="updateRejection()">
            <div style="font-size:0.8rem;color:var(--text-secondary);margin-top:0.25rem">ìœ ì‚¬ë„: <span id="rej_sim_val">30</span>%</div>
          </div>
          <div class="form-group" style="margin-bottom:0">
            <label class="form-label" style="font-size:0.75rem">ì²­êµ¬í•­ ìˆ˜</label>
            <input type="range" class="score-slider" id="rej_claims" min="1" max="30" value="15" oninput="updateRejection()">
            <div style="font-size:0.8rem;color:var(--text-secondary);margin-top:0.25rem">ì²­êµ¬í•­: <span id="rej_claims_val">15</span>ê°œ</div>
          </div>
        </div>
        <div style="text-align:center;padding:1rem">
          <div style="font-size:0.85rem;color:var(--text-secondary);margin-bottom:0.5rem">ê±°ì ˆ ì˜ˆì¸¡ í™•ë¥ </div>
          <div style="font-size:3.5rem;font-weight:900;line-height:1" id="rej_pct_display">27%</div>
          <div id="rej_grade" class="badge badge-green" style="margin:0.75rem auto;display:inline-block">ì €ìœ„í—˜</div>
          <div style="font-size:0.8rem;color:var(--text-secondary);margin-top:0.75rem" id="rej_advice">
            í˜„ì¬ ì²­êµ¬í•­ êµ¬ì¡° ì–‘í˜¸. ì¢…ì†í•­ ì¶”ê°€ ê¶Œì¥.
          </div>
        </div>
      </div>
    </div>

    <div style="text-align:right;margin-top:1.5rem">
      <button class="btn btn-primary" onclick="goStep(7)">
        ë‹¤ìŒ: ìµœì¢… ëª…ì„¸ì„œ ìƒì„± â†’
      </button>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STEP 7 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="step-panel" id="step-7">
    <div class="card" style="margin-bottom:1.5rem">
      <h2 class="section-title" style="font-size:1.2rem">STEP 7 Â· ìµœì¢… íŠ¹í—ˆ ëª…ì„¸ì„œ ìë™ ìƒì„±</h2>
      <p class="section-sub" style="margin-bottom:1rem">íŠ¹í—ˆì²­ ì œì¶œìš© ì™„ì„± ëª…ì„¸ì„œë¥¼ AIê°€ ìë™ ì‘ì„±í•©ë‹ˆë‹¤.</p>

      <div style="display:flex;gap:1rem;flex-wrap:wrap">
        <button class="btn btn-primary btn-lg" onclick="runStep7()">
          ğŸ“„ ëª…ì„¸ì„œ ì „ì²´ ìƒì„±
        </button>
        <div id="s7Loading" style="display:none;align-items:center;gap:0.5rem">
          <div class="spinner"></div>
          <span style="color:var(--text-secondary);font-size:0.875rem">ëª…ì„¸ì„œ ì‘ì„± ì¤‘...</span>
        </div>
      </div>
    </div>

    <div class="card" id="s7SpecWrap">
      <!-- Score Summary Bar -->
      <div id="s7ScoreSummary" style="display:none;background:var(--bg-dark);border-radius:10px;padding:1.25rem;margin-bottom:1.5rem">
        <div style="display:flex;gap:2rem;flex-wrap:wrap;justify-content:center">
          <div style="text-align:center">
            <div style="font-size:0.75rem;color:var(--text-secondary)">PSM ì ìˆ˜</div>
            <div style="font-size:2rem;font-weight:800;color:#60a5fa" id="s7_psm">-</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:0.75rem;color:var(--text-secondary)">RSI ì§€ìˆ˜</div>
            <div style="font-size:2rem;font-weight:800;color:#34d399" id="s7_rsi">-</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:0.75rem;color:var(--text-secondary)">ê±°ì ˆ í™•ë¥ </div>
            <div style="font-size:2rem;font-weight:800;color:#fbbf24" id="s7_rej">-</div>
          </div>
          <div style="text-align:center">
            <div style="font-size:0.75rem;color:var(--text-secondary)">ì „ëµ ë“±ê¸‰</div>
            <div style="font-size:1.5rem;font-weight:800" id="s7_grade">-</div>
          </div>
        </div>
      </div>

      <div id="s7Spec" class="final-spec">
        <div style="color:var(--text-secondary);text-align:center;padding:3rem">
          ëª…ì„¸ì„œ ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì „ì²´ ëª…ì„¸ì„œê°€ ìë™ ì‘ì„±ë©ë‹ˆë‹¤.
        </div>
      </div>
    </div>

    <div style="display:flex;gap:1rem;margin-top:1.5rem;flex-wrap:wrap">
      <button class="btn btn-success btn-lg" onclick="printSpec()">
        ğŸ–¨ï¸ PDF ì¶œë ¥
      </button>
      <button class="btn btn-secondary btn-lg" onclick="copySpec()">
        ğŸ“‹ ì „ì²´ ë³µì‚¬
      </button>
      <a href="dashboard.html" class="btn btn-outline btn-lg">
        ğŸ“Š í¬íŠ¸í´ë¦¬ì˜¤ì— ì¶”ê°€
      </a>
      <a href="index.html" class="btn btn-outline btn-lg">
        ğŸ”„ ìƒˆ í”„ë¡œì íŠ¸
      </a>
    </div>
  </div>

</div><!-- /page-content -->

<script src="assets/js/common.js"></script>
<script src="assets/js/layout.js"></script>
<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// State
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentStep = 1;
const maxSteps = 7;
const stepResults = {};
let proj = {};

// Load project
window.addEventListener('DOMContentLoaded', () => {
  proj = getProject() || {};
  const bar = document.getElementById('projectInfoBar');
  if (proj.title) {
    bar.innerHTML = `<strong>${proj.title}</strong> Â· ${proj.industry || 'ë¶„ì•¼ ë¯¸ì§€ì •'} Â· ${proj.idea ? proj.idea.substring(0,80)+'...' : ''}`;
    document.getElementById('s1Idea').value = proj.idea || '';
  } else {
    bar.innerHTML = `<span style="color:rgba(255,200,100,0.9)">âš  í™ˆì—ì„œ í”„ë¡œì íŠ¸ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</span>`;
  }
  initScores();
  updateRSI();
  updateRejection();
});

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Step Navigation
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function goStep(n) {
  document.getElementById(`step-${currentStep}`).classList.remove('active');
  document.getElementById(`nav-${currentStep}`).classList.remove('active');
  currentStep = n;
  document.getElementById(`step-${n}`).classList.add('active');
  document.getElementById(`nav-${n}`).classList.add('active');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function markDone(n) {
  const btn = document.getElementById(`nav-${n}`);
  if (btn) { btn.classList.remove('active'); btn.classList.add('done'); }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 1 - Core Extraction
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runStep1() {
  const idea = document.getElementById('s1Idea').value.trim();
  if (!idea) { showToast('ì•„ì´ë””ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'warning'); return; }

  const diff = document.getElementById('s1Diff').value;
  const commerce = document.getElementById('s1Commerce').value;
  const techType = document.getElementById('s1TechType').value;

  const prompt = `ë‹¹ì‹ ì€ íŠ¹í—ˆ ì „ë¬¸ê°€ AIì…ë‹ˆë‹¤. ì•„ë˜ ë°œëª… ë‚´ìš©ì„ ë¶„ì„í•˜ì—¬ íŠ¹í—ˆ ì¶œì›ì„ ìœ„í•œ í•µì‹¬ ìš”ì†Œë¥¼ ì¶”ì¶œí•´ì£¼ì„¸ìš”.

[ë°œëª… ë‚´ìš©]
${idea}
${diff ? `[ê¸°ì¡´ ê¸°ìˆ ê³¼ì˜ ì°¨ì´ì ] ${diff}` : ''}
${commerce ? `[ìƒì—…ì  í•µì‹¬ ìš”ì†Œ] ${commerce}` : ''}
[ê¸°ìˆ  ìœ í˜•] ${techType}
[ì‚°ì—… ë¶„ì•¼] ${proj.industry || ''}

ë‹¤ìŒ êµ¬ì¡°ë¡œ ë¶„ì„í•´ì£¼ì„¸ìš”:

## 1. ë°œëª…ì˜ í•µì‹¬ ê°œë… (3ì¤„ ìš”ì•½)
ë°œëª…ì´ í•´ê²°í•˜ëŠ” ë¬¸ì œì™€ í•´ê²° ë°©ë²•ì„ ëª…í™•í•˜ê²Œ 3ì¤„ë¡œ ìš”ì•½.

## 2. ê¸°ìˆ ì  ê³¼ì œ ì •ì˜
ê¸°ì¡´ ê¸°ìˆ ì˜ ë¬¸ì œì ê³¼ ë³¸ ë°œëª…ì´ í•´ê²°í•˜ê³ ì í•˜ëŠ” ê³¼ì œ.

## 3. í•´ê²° ìˆ˜ë‹¨
ë°œëª…ì˜ í•µì‹¬ ê¸°ìˆ ì  í•´ê²° ë°©ë²•ê³¼ ì‘ë™ ì›ë¦¬.

## 4. ê¸°ìˆ  ìœ í˜• ë¶„ë¥˜
ë°œëª…ì˜ ê¸°ìˆ  ìœ í˜• (ì•Œê³ ë¦¬ì¦˜í˜•/ì‹œìŠ¤í…œí˜•/ì¥ì¹˜í˜•/ê³µì •í˜•/ìœµí•©í˜•) ë° ë¶„ë¥˜ ì´ìœ .

## 5. ì£¼ìš” ê¸°ìˆ  í‚¤ì›Œë“œ (10ê°œ)
íŠ¹í—ˆ ê²€ìƒ‰ ë° ì²­êµ¬í•­ ì‘ì„±ì— í™œìš©í•  í•µì‹¬ í‚¤ì›Œë“œ ëª©ë¡.

## 6. ê¸°ëŒ€ íš¨ê³¼
ë³¸ ë°œëª…ìœ¼ë¡œ ì–»ì„ ìˆ˜ ìˆëŠ” ê¸°ìˆ ì Â·ê²½ì œì  íš¨ê³¼.

## 7. ì¶”ê°€ ë³´ê°• ì œì•ˆ
íŠ¹í—ˆ ê°•ë„ë¥¼ ë†’ì´ê¸° ìœ„í•´ ë³´ì™„í•´ì•¼ í•  ì‚¬í•­.

í•œêµ­ì–´ë¡œ ì‘ì„±í•˜ê³ , ì‹¤ì œ íŠ¹í—ˆ ëª…ì„¸ì„œ ìˆ˜ì¤€ì˜ ì „ë¬¸ì„±ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

  const loading = document.getElementById('s1Loading');
  const result = document.getElementById('s1Result');
  loading.style.display = 'block';
  result.innerHTML = '';

  try {
    let fullText = '';
    await callGemini(prompt, (chunk, full) => {
      fullText = full;
      result.innerHTML = formatMarkdown(full);
    });
    stepResults.step1 = fullText;
    saveProject({ step1: fullText });
    document.getElementById('s1Next').disabled = false;
    markDone(1);
    showToast('í•µì‹¬ ì¶”ì¶œ ì™„ë£Œ!', 'success');
  } catch (e) {
    result.innerHTML = `<span style="color:#f87171">ì˜¤ë¥˜: ${e.message}</span>`;
    showToast(e.message, 'error');
  } finally {
    loading.style.display = 'none';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 2 - Prior Art Analysis
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runStep2() {
  const scope = document.getElementById('s2Scope').value;
  const keywords = document.getElementById('s2Keywords').value;
  const step1 = stepResults.step1 || proj.idea || '';

  const prompt = `ë‹¹ì‹ ì€ íŠ¹í—ˆ ê²€ìƒ‰ ë° ì„ í–‰ê¸°ìˆ  ë¶„ì„ ì „ë¬¸ê°€ AIì…ë‹ˆë‹¤.

[ë°œëª… ê°œìš”]
${step1.substring(0, 800)}
${keywords ? `[ì¶”ê°€ í‚¤ì›Œë“œ] ${keywords}` : ''}
[ê²€ìƒ‰ ë²”ìœ„] ${scope}

ë‹¤ìŒ êµ¬ì¡°ë¡œ ì„ í–‰ê¸°ìˆ  ë¶„ì„ ë³´ê³ ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

## 1. ê²€ìƒ‰ ì „ëµ
ì‚¬ìš©ëœ ê²€ìƒ‰ ì¿¼ë¦¬ì™€ í‚¤ì›Œë“œ ì¡°í•©ì„ ì„¤ëª….

## 2. ìœ ì‚¬ ì„ í–‰ê¸°ìˆ  ë¶„ì„ (ê°€ìƒ ì‚¬ë¡€ 3ê±´)
ê° ì„ í–‰ê¸°ìˆ ì— ëŒ€í•´:
- ì¶œì²˜ ë° íŠ¹í—ˆ ìœ í˜•
- ê¸°ìˆ  ë‚´ìš© ìš”ì•½
- ë³¸ ë°œëª…ê³¼ì˜ ìœ ì‚¬ì 
- ë³¸ ë°œëª…ê³¼ì˜ ì°¨ë³„ì 
- ìœ ì‚¬ë„ ì¶”ì • (%)

## 3. ì‹ ê·œì„± ìœ„í—˜ í‰ê°€
| ìœ„í—˜ ìš”ì†Œ | ìœ„í—˜ ìˆ˜ì¤€ | ëŒ€ì‘ ë°©ì•ˆ |
í˜•ì‹ìœ¼ë¡œ í‘œ ì‘ì„±.

## 4. ì°¨ë³„ì„± ë§¤íŠ¸ë¦­ìŠ¤
| ê¸°ì¡´ê¸°ìˆ  ë¬¸ì œì  | ë³¸ ë°œëª… í•´ê²°ë°©ë²• | ê¸°ëŒ€íš¨ê³¼ |
í˜•ì‹ì˜ ë¹„êµ í‘œ ì‘ì„±.

## 5. ì‹ ê·œì„±Â·ì§„ë³´ì„± íŒë‹¨
ë³¸ ë°œëª…ì˜ ì‹ ê·œì„±ê³¼ ì§„ë³´ì„±ì— ëŒ€í•œ ì „ë¬¸ì  ì˜ê²¬.

## 6. ë³´ì™„ ê¶Œê³ ì‚¬í•­
íŠ¹í—ˆ ë“±ë¡ ê°€ëŠ¥ì„±ì„ ë†’ì´ê¸° ìœ„í•œ êµ¬ì²´ì  ë³´ì™„ ì œì•ˆ.

í•œêµ­ì–´ë¡œ ì‘ì„±í•˜ê³ , ê°€ëŠ¥í•œ êµ¬ì²´ì ì´ê³  ì‹¤ë¬´ì ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

  const loading = document.getElementById('s2Loading');
  const result = document.getElementById('s2Result');
  loading.style.display = 'block';
  result.innerHTML = '';

  try {
    let fullText = '';
    await callGemini(prompt, (chunk, full) => {
      fullText = full;
      result.innerHTML = formatMarkdown(full);
    });
    stepResults.step2 = fullText;
    saveProject({ step2: fullText });

    // Update risk display
    document.getElementById('s2Risk').innerHTML = `
      <div class="risk-meter" style="background:rgba(5,150,105,0.1);border-color:rgba(5,150,105,0.3)">
        <div class="risk-pct" style="color:#34d399">30%</div>
        <div>
          <div style="font-weight:700;color:#34d399">ì €ìœ„í—˜ Â· ì‹ ê·œì„± ë†’ìŒ</div>
          <div style="font-size:0.8rem;color:var(--text-secondary)">ë¶„ì„ ê²°ê³¼ ì„ í–‰ê¸°ìˆ ê³¼ì˜ ì°¨ë³„ì„±ì´ ì¶©ë¶„í•©ë‹ˆë‹¤.</div>
        </div>
      </div>`;
    document.getElementById('s2Next').disabled = false;
    markDone(2);
    showToast('ì„ í–‰ê¸°ìˆ  ë¶„ì„ ì™„ë£Œ!', 'success');
  } catch (e) {
    result.innerHTML = `<span style="color:#f87171">ì˜¤ë¥˜: ${e.message}</span>`;
    showToast(e.message, 'error');
  } finally {
    loading.style.display = 'none';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 3 - Component Decomposition
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runStep3() {
  const coreInput = document.getElementById('s3Core').value;
  const step1 = stepResults.step1 || proj.idea || '';

  const prompt = `íŠ¹í—ˆ ì „ë¬¸ê°€ë¡œì„œ ì•„ë˜ ë°œëª…ì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ë¶„í•´í•´ì£¼ì„¸ìš”.

[ë°œëª… ë¶„ì„ ë‚´ìš©]
${step1.substring(0, 600)}
${coreInput ? `[í•„ìˆ˜ ë³´í˜¸ êµ¬ì„±ìš”ì†Œ] ${coreInput}` : ''}

ë‹¤ìŒ êµ¬ì¡°ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”:

## 1. í•µì‹¬ êµ¬ì„±ìš”ì†Œ (A, B, C... êµ¬ë¶„)
ê° êµ¬ì„±ìš”ì†Œì— ëŒ€í•´:
- ëª…ì¹­
- ê¸°ëŠ¥ ë° ì—­í• 
- ê¸°ìˆ ì  íŠ¹ì„±
- ë³´í˜¸ ì¤‘ìš”ë„ (ìƒ/ì¤‘/í•˜)

## 2. êµ¬ì„±ìš”ì†Œ ê°„ ì—°ê²° ê´€ê³„
ë°ì´í„° íë¦„ ë˜ëŠ” ì‘ë™ ìˆœì„œë¥¼ ë‹¨ê³„ë³„ë¡œ ì„¤ëª….

## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
ì „ì²´ êµ¬ì¡°ë¥¼ í…ìŠ¤íŠ¸ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ í‘œí˜„.

## 4. ì²­êµ¬í•­ ì‘ì„±ì„ ìœ„í•œ êµ¬ì„±ìš”ì†Œ ê³„ì¸µí™”
- í•„ìˆ˜ ë…ë¦½í•­ êµ¬ì„±ìš”ì†Œ
- ì„ íƒì  ì¢…ì†í•­ êµ¬ì„±ìš”ì†Œ
- í™•ì¥ ê°€ëŠ¥í•œ ë³€í˜• êµ¬ì„±ìš”ì†Œ

## 5. ì‚­ì œ ê°€ëŠ¥í•œ ë³´ì¡° ìš”ì†Œ
ê¶Œë¦¬ ë²”ìœ„ì— ì˜í–¥ ì—†ì´ ì‚­ì œ ê°€ëŠ¥í•œ ìš”ì†Œ ëª©ë¡.

í•œêµ­ì–´ë¡œ ì‹¤ë¬´ íŠ¹í—ˆ ìˆ˜ì¤€ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

  const loading = document.getElementById('s3Loading');
  const result = document.getElementById('s3Result');
  loading.style.display = 'block';
  result.innerHTML = '';

  try {
    let fullText = '';
    await callGemini(prompt, (chunk, full) => {
      fullText = full;
      result.innerHTML = formatMarkdown(full);
    });
    stepResults.step3 = fullText;
    saveProject({ step3: fullText });
    document.getElementById('s3Next').disabled = false;
    markDone(3);
    showToast('êµ¬ì„±ìš”ì†Œ ë¶„í•´ ì™„ë£Œ!', 'success');
  } catch (e) {
    result.innerHTML = `<span style="color:#f87171">ì˜¤ë¥˜: ${e.message}</span>`;
    showToast(e.message, 'error');
  } finally {
    loading.style.display = 'none';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 4 - Claims Design
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runStep4() {
  const indepCount = parseInt(document.getElementById('s4IndepCount').value);
  const depCount = parseInt(document.getElementById('s4DepCount').value);
  const step1 = stepResults.step1 || proj.idea || '';
  const step3 = stepResults.step3 || '';

  const prompt = `íŠ¹í—ˆ ì²­êµ¬í•­ ì „ë¬¸ AIì…ë‹ˆë‹¤. ì•„ë˜ ë°œëª…ì„ ê¸°ë°˜ìœ¼ë¡œ íŠ¹í—ˆì²­ ë“±ë¡ ìˆ˜ì¤€ì˜ ì²­êµ¬í•­ì„ ì‘ì„±í•´ì£¼ì„¸ìš”.

[ë°œëª… ë‚´ìš©]
${step1.substring(0, 500)}
[êµ¬ì„±ìš”ì†Œ]
${step3.substring(0, 400)}

ìš”êµ¬ì‚¬í•­:
- ë…ë¦½í•­: ${indepCount}ê°œ (ë°©ë²•/ì‹œìŠ¤í…œ/ì¥ì¹˜ ì²­êµ¬í•­ í¬í•¨)
- ì¢…ì†í•­: ${depCount}ê°œ
- íšŒí”¼ì„¤ê³„ ë°©ì–´í•­: 3ê°œ ì¶”ê°€

ê° ì²­êµ¬í•­ì„ ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ì„±:

[ì²­êµ¬í•­ 1 - ë…ë¦½í•­]
[ë°©ë²• ì²­êµ¬í•­]
...ì„ í¬í•¨í•˜ëŠ” ë°©ë²•ì— ìˆì–´ì„œ, ...í•˜ëŠ” ë‹¨ê³„; ...í•˜ëŠ” ë‹¨ê³„; ë¥¼ í¬í•¨í•˜ëŠ” ê²ƒì„ íŠ¹ì§•ìœ¼ë¡œ í•˜ëŠ” ...ë°©ë²•.

[ì²­êµ¬í•­ 2 - ë…ë¦½í•­]
[ì‹œìŠ¤í…œ ì²­êµ¬í•­]
...

[ì²­êµ¬í•­ 3 ì´í›„ - ì¢…ì†í•­]
ì œ1í•­ì— ìˆì–´ì„œ, ...ë¥¼ ë” í¬í•¨í•˜ëŠ” ê²ƒì„ íŠ¹ì§•ìœ¼ë¡œ í•˜ëŠ” ...

[íšŒí”¼ì„¤ê³„ ë°©ì–´í•­]
...

í•œêµ­ íŠ¹í—ˆë²• ì œ42ì¡° í˜•ì‹ì— ë§ê²Œ ì‘ì„±í•˜ê³ , ìµœëŒ€í•œ ë„“ì€ ê¶Œë¦¬ ë²”ìœ„ë¥¼ í™•ë³´í•´ì£¼ì„¸ìš”.`;

  const loading = document.getElementById('s4Loading');
  loading.style.display = 'inline-flex';
  loading.style.alignItems = 'center';

  try {
    const result = await callGemini(prompt);
    stepResults.step4 = result;
    saveProject({ step4: result });

    // Parse and render claims
    renderClaims(result);
    document.getElementById('s4Next').disabled = false;
    markDone(4);
    showToast('ì²­êµ¬í•­ ìƒì„± ì™„ë£Œ!', 'success');
  } catch (e) {
    showToast(e.message, 'error');
  } finally {
    loading.style.display = 'none';
  }
}

function renderClaims(text) {
  const container = document.getElementById('s4Claims');
  // Simple parsing - split by claim markers
  const claimLines = text.split('\n').filter(l => l.trim());
  let html = '';
  let inClaim = false;
  let claimNum = 0;
  let currentClaim = '';
  let claimType = 'independent';

  claimLines.forEach(line => {
    const isClaimStart = line.match(/\[ì²­êµ¬í•­\s*(\d+)/);
    if (isClaimStart) {
      if (currentClaim) {
        html += renderClaimItem(claimNum, claimType, currentClaim);
      }
      claimNum++;
      currentClaim = '';
      claimType = line.toLowerCase().includes('ë…ë¦½') ? 'independent' :
                  line.toLowerCase().includes('ë°©ì–´') ? 'defense' : 'dependent';
    } else if (claimNum > 0) {
      currentClaim += line + '\n';
    }
  });
  if (currentClaim) html += renderClaimItem(claimNum, claimType, currentClaim);

  // Fallback: show raw text in nice box
  if (!html) {
    html = `<div class="claim-item">
      <div class="claim-header">
        <span class="claim-tag independent">ìƒì„±ëœ ì²­êµ¬í•­</span>
      </div>
      <div style="font-size:0.875rem;line-height:1.8;white-space:pre-wrap">${text}</div>
    </div>`;
  }

  container.innerHTML = html;
}

function renderClaimItem(num, type, text) {
  const tagClass = type === 'independent' ? 'independent' : type === 'defense' ? 'defense' : 'dependent';
  const tagLabel = type === 'independent' ? 'ë…ë¦½í•­' : type === 'defense' ? 'ë°©ì–´í•­' : 'ì¢…ì†í•­';
  return `<div class="claim-item">
    <div class="claim-header">
      <span class="claim-num">ì œ${num}í•­</span>
      <span class="claim-tag ${tagClass}">${tagLabel}</span>
    </div>
    <div class="claim-text-area" style="min-height:40px;white-space:pre-wrap">${text.trim()}</div>
  </div>`;
}

function addClaim() {
  const container = document.getElementById('s4Claims');
  const newItem = document.createElement('div');
  newItem.className = 'claim-item';
  newItem.innerHTML = `
    <div class="claim-header">
      <span class="claim-num">ìƒˆ ì²­êµ¬í•­</span>
      <span class="claim-tag dependent">ì¢…ì†í•­</span>
    </div>
    <textarea class="claim-text-area" style="min-height:80px;border:none;outline:none"
      placeholder="ì²­êµ¬í•­ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
  `;
  container.appendChild(newItem);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 5 - Examples
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runStep5() {
  const type = document.getElementById('s5Type').value;
  const step1 = stepResults.step1 || proj.idea || '';

  const prompt = `íŠ¹í—ˆ ëª…ì„¸ì„œ ì‘ì„± ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì•„ë˜ ë°œëª…ì˜ ì‹¤ì‹œì˜ˆë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

[ë°œëª… ë‚´ìš©]
${step1.substring(0, 600)}
[ì‹¤ì‹œì˜ˆ ìœ í˜•] ${type}

ë‹¤ìŒ êµ¬ì¡°ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”:

## 1. ì œ1 ì‹¤ì‹œì˜ˆ (ê¸°ë³¸ êµ¬í˜„)
ë°œëª…ì˜ í•µì‹¬ êµ¬ì„±ì„ í¬í•¨í•œ ê¸°ë³¸ì ì¸ êµ¬í˜„ ì˜ˆì‹œ. êµ¬ì²´ì ì¸ ìˆ˜ì¹˜, ì¡°ê±´, í™˜ê²½ í¬í•¨.

## 2. ì œ2 ì‹¤ì‹œì˜ˆ (ë³€í˜• êµ¬í˜„)
í•µì‹¬ êµ¬ì„±ì€ ìœ ì§€í•˜ë˜ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•œ ë³€í˜• ì˜ˆì‹œ.

## 3. ì œ3 ì‹¤ì‹œì˜ˆ (í™•ì¥ êµ¬í˜„)
ë¶€ê°€ì ì¸ ê¸°ëŠ¥ì´ë‚˜ êµ¬ì„±ì„ ì¶”ê°€í•œ í™•ì¥ ì˜ˆì‹œ.

## 4. ì‚°ì—…ë³„ ì ìš© ì‚¬ë¡€
ë³¸ ë°œëª…ì´ ì ìš©ë  ìˆ˜ ìˆëŠ” 3ê°œ ì´ìƒì˜ ì‚°ì—… ë¶„ì•¼ì™€ êµ¬ì²´ì  í™œìš© ë°©ë²•.

## 5. ë¹„êµ ì‹¤í—˜ ê²°ê³¼ (ì˜ˆì‹œ)
ê¸°ì¡´ ê¸°ìˆ  ëŒ€ë¹„ ë³¸ ë°œëª…ì˜ íš¨ê³¼ë¥¼ ìˆ˜ì¹˜ë¡œ í‘œí˜„í•œ ì˜ˆì‹œ ë°ì´í„°.

ì‹¤ì œ íŠ¹í—ˆ ëª…ì„¸ì„œì˜ ì‹¤ì‹œì˜ˆ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

  const loading = document.getElementById('s5Loading');
  const result = document.getElementById('s5Result');
  loading.style.display = 'block';
  result.innerHTML = '';

  try {
    let fullText = '';
    await callGemini(prompt, (chunk, full) => {
      fullText = full;
      result.innerHTML = formatMarkdown(full);
    });
    stepResults.step5 = fullText;
    saveProject({ step5: fullText });
    document.getElementById('s5Next').disabled = false;
    markDone(5);
    showToast('ì‹¤ì‹œì˜ˆ ìƒì„± ì™„ë£Œ!', 'success');
  } catch (e) {
    result.innerHTML = `<span style="color:#f87171">ì˜¤ë¥˜: ${e.message}</span>`;
    showToast(e.message, 'error');
  } finally {
    loading.style.display = 'none';
  }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 6 - Scoring
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const scoreKeys = ['novelty','inventive','industrial','effect','claims','defense','expansion'];
const scoreWeights = { novelty:0.25, inventive:0.20, industrial:0.10, effect:0.10, claims:0.15, defense:0.10, expansion:0.10 };

function initScores() {
  scoreKeys.forEach(k => updateScore(k));
  updateRSI();
}

function updateScore(key) {
  const val = parseInt(document.getElementById(`sl_${key}`).value);
  const colors = { novelty:'#60a5fa', inventive:'#a78bfa', industrial:'#34d399', effect:'#fbbf24', claims:'#f87171', defense:'#fb923c', expansion:'#38bdf8' };
  document.getElementById(`sc_${key}`).textContent = val;
  document.getElementById(`sc_${key}`).style.color = colors[key];
  recalcPSM();
}

function recalcPSM() {
  const scores = {};
  scoreKeys.forEach(k => { scores[k] = parseInt(document.getElementById(`sl_${k}`).value); });
  const psm = calcPSM(scores);
  document.getElementById('psm_total').textContent = psm;
  const g = getPSMGrade(psm);
  const gradeEl = document.getElementById('psm_grade');
  gradeEl.textContent = g.grade;
  gradeEl.style.background = g.color + '33';
  gradeEl.style.color = g.color;
  return psm;
}

function updateRSI() {
  const l = parseInt(document.getElementById('rsi_l').value);
  const t = parseInt(document.getElementById('rsi_t').value);
  const m = parseInt(document.getElementById('rsi_m').value);
  const v = parseInt(document.getElementById('rsi_v').value);
  document.getElementById('rsi_l_val').textContent = l;
  document.getElementById('rsi_t_val').textContent = t;
  document.getElementById('rsi_m_val').textContent = m;
  document.getElementById('rsi_v_val').textContent = v;
  const rsi = calcRSI(l, t, m, v);
  document.getElementById('rsi_value').textContent = rsi;
  const g = getRSIGrade(rsi);
  const gradeEl = document.getElementById('rsi_grade');
  gradeEl.textContent = g.grade;
  document.getElementById('rsi_needle').style.left = g.pct + '%';
}

function updateRejection() {
  const sim = parseInt(document.getElementById('rej_sim').value);
  const claims = parseInt(document.getElementById('rej_claims').value);
  document.getElementById('rej_sim_val').textContent = sim;
  document.getElementById('rej_claims_val').textContent = claims;
  const psm = recalcPSM();
  const prob = calcRejectionProb(sim / 100, psm, claims);
  const pct = Math.round(prob * 100);
  document.getElementById('rej_pct_display').textContent = pct + '%';
  const gradeEl = document.getElementById('rej_grade');
  if (pct >= 60) {
    gradeEl.textContent = 'ê³ ìœ„í—˜';
    gradeEl.className = 'badge badge-red';
    document.getElementById('rej_advice').textContent = 'âš  ì²­êµ¬í•­ ì „ë©´ ì¬ì„¤ê³„ ê¶Œê³ . ë…ë¦½í•­ ë²”ìœ„ ì¶•ì†Œ í•„ìš”.';
  } else if (pct >= 40) {
    gradeEl.textContent = 'ì¤‘ìœ„í—˜';
    gradeEl.className = 'badge badge-yellow';
    document.getElementById('rej_advice').textContent = 'â–³ ì¢…ì†í•­ ì¶”ê°€ ë° ì‹¤ì‹œì˜ˆ ë³´ê°• ê¶Œê³ .';
  } else {
    gradeEl.textContent = 'ì €ìœ„í—˜';
    gradeEl.className = 'badge badge-green';
    document.getElementById('rej_advice').textContent = 'âœ“ í˜„ì¬ êµ¬ì¡° ì–‘í˜¸. ë°©ì–´í•­ ì¶”ê°€ë¡œ ê°•í™” ê°€ëŠ¥.';
  }
  document.getElementById('rej_pct_display').style.color = pct >= 60 ? '#f87171' : pct >= 40 ? '#fbbf24' : '#34d399';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STEP 7 - Final Specification
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function runStep7() {
  const step1 = stepResults.step1 || proj.idea || '';
  const step2 = stepResults.step2 || '';
  const step3 = stepResults.step3 || '';
  const step4 = stepResults.step4 || '';
  const step5 = stepResults.step5 || '';

  const psm = recalcPSM();
  const l = parseInt(document.getElementById('rsi_l').value);
  const t = parseInt(document.getElementById('rsi_t').value);
  const m = parseInt(document.getElementById('rsi_m').value);
  const v = parseInt(document.getElementById('rsi_v').value);
  const rsi = calcRSI(l, t, m, v);
  const sim = parseInt(document.getElementById('rej_sim').value);
  const claimsCount = parseInt(document.getElementById('rej_claims').value);
  const rejProb = Math.round(calcRejectionProb(sim/100, psm, claimsCount) * 100);

  const prompt = `ë‹¹ì‹ ì€ íŠ¹í—ˆì²­ ë“±ë¡ ìˆ˜ì¤€ì˜ íŠ¹í—ˆ ëª…ì„¸ì„œë¥¼ ì‘ì„±í•˜ëŠ” ì „ë¬¸ ë³€ë¦¬ì‚¬ AIì…ë‹ˆë‹¤.
ì•„ë˜ ë¶„ì„ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ í•œêµ­ íŠ¹í—ˆì²­ ì œì¶œìš© ì™„ì„± ëª…ì„¸ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”.

[ë°œëª… ë¶„ì„]
${step1.substring(0, 400)}
[ì„ í–‰ê¸°ìˆ  ë¶„ì„ ìš”ì•½]
${step2.substring(0, 300)}
[êµ¬ì„±ìš”ì†Œ]
${step3.substring(0, 300)}
[ì²­êµ¬í•­]
${step4.substring(0, 400)}
[ì‹¤ì‹œì˜ˆ]
${step5.substring(0, 300)}
[ë°œëª… ì œëª©] ${proj.title || ''}
[ì‚°ì—… ë¶„ì•¼] ${proj.industry || ''}

ë‹¤ìŒ íŠ¹í—ˆì²­ í‘œì¤€ í˜•ì‹ìœ¼ë¡œ ì™„ì„± ëª…ì„¸ì„œë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”:

ã€ë°œëª…ì˜ ëª…ì¹­ã€‘
(ë°œëª…ì˜ ëª…ì¹­)

ã€ê¸°ìˆ ë¶„ì•¼ã€‘
ë³¸ ë°œëª…ì€...

ã€ë°°ê²½ê¸°ìˆ ã€‘
ì¢…ë˜ì˜...ë¬¸ì œì ì´ ìˆì—ˆë‹¤.

ã€ë°œëª…ì˜ ë‚´ìš©ã€‘
ã€í•´ê²°í•˜ë ¤ëŠ” ê³¼ì œã€‘
ã€ê³¼ì œì˜ í•´ê²° ìˆ˜ë‹¨ã€‘
ã€ë°œëª…ì˜ íš¨ê³¼ã€‘

ã€ë„ë©´ì˜ ê°„ë‹¨í•œ ì„¤ëª…ã€‘
ë„ 1ì€...
ë„ 2ëŠ”...

ã€ë°œëª…ì˜ ì‹¤ì‹œë¥¼ ìœ„í•œ êµ¬ì²´ì ì¸ ë‚´ìš©ã€‘
ì´í•˜, ì²¨ë¶€ ë„ë©´ì„ ì°¸ì¡°í•˜ì—¬...

ã€ì²­êµ¬ë²”ìœ„ã€‘
ã€ì²­êµ¬í•­ 1ã€‘
...

ê° ì„¹ì…˜ì„ ì¶©ë¶„íˆ ìì„¸í•˜ê²Œ ì‘ì„±í•˜ê³ , ì‹¤ì œ íŠ¹í—ˆì²­ ì œì¶œ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

  const loading = document.getElementById('s7Loading');
  loading.style.display = 'flex';

  // Show score summary
  document.getElementById('s7ScoreSummary').style.display = 'block';
  document.getElementById('s7_psm').textContent = psm;
  document.getElementById('s7_rsi').textContent = rsi;
  document.getElementById('s7_rej').textContent = rejProb + '%';
  const rsiGrade = getRSIGrade(rsi);
  document.getElementById('s7_grade').textContent = rsiGrade.grade;
  document.getElementById('s7_grade').style.color = rsiGrade.color;

  try {
    const specEl = document.getElementById('s7Spec');
    specEl.innerHTML = '';
    let fullText = '';
    await callGemini(prompt, (chunk, full) => {
      fullText = full;
      specEl.innerHTML = formatMarkdown(full);
    });
    stepResults.step7 = fullText;
    saveProject({ step7: fullText, psm, rsi, rejProb });
    markDone(7);
    showToast('ëª…ì„¸ì„œ ìƒì„± ì™„ë£Œ!', 'success');
  } catch (e) {
    document.getElementById('s7Spec').innerHTML = `<span style="color:#f87171">ì˜¤ë¥˜: ${e.message}</span>`;
    showToast(e.message, 'error');
  } finally {
    loading.style.display = 'none';
  }
}

function printSpec() {
  const content = stepResults.step7 || 'ëª…ì„¸ì„œë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.';
  generatePDF(`íŠ¹í—ˆ ëª…ì„¸ì„œ - ${proj.title || ''}`, content);
}

function copySpec() {
  const content = stepResults.step7 || '';
  navigator.clipboard.writeText(content).then(() => showToast('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success'));
}
</script>
</body>
</html>
